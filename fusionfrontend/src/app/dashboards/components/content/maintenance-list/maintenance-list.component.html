<div>
  <div class="p-grid p-jc-between header-line">
    <h3 class="table-header">Maintenance Dashboard</h3>
    <div class="filter-panel">
      <app-table-filter class="filter-btn" [possibleFilters]="this.possibleFilters" [itemsToBeFiltered]="this.factoryAssetDetailsWithFields"
                        [position]="[50, -450]" (filteredItems)="filterAssets($event)">
      </app-table-filter>
    </div>
  </div>

  <p-table [paginator]="true"
           [rowsPerPageOptions]="[5,10,50]"
           [rows]="10"
           [showCurrentPageReport]="true"
           [value]="displayedFactoryAssets" class="list-container"
           currentPageReportTemplate="{first} to {last} of {totalRecords} Assets">
    <ng-template pTemplate="header">
      <tr>
        <th [style.width.%]="2"></th>
        <th [style.width.%]="4"></th>
        <th [style.width.%]="20">
          <app-table-searchbar filterColumn="Asset" [itemsToBeFiltered]="this.factoryAssetDetailsWithFields"
                               attributeToBeSearched="name" (searchByName)="searchAssets($event)">
          </app-table-searchbar>
        </th>
        <th [style.width.%]="18" pSortableColumn="category">Asset Type
          <p-sortIcon field="category"></p-sortIcon>
        </th>
        <th [style.width.%]="20">Manufacturer</th>
        <th [style.width.%]="12">Factory</th>
        <th [style.width.%]="13">Days till Maintenance</th>
        <th [style.width.%]="13">Operating Hours till Maintenance</th>
        <th [style.width.%]="2"></th>
      </tr>
    </ng-template>

    <ng-template let-asset pTemplate="body">
      <tr>
        <td [style.width.%]="2"></td>
        <td [style.width.%]="4">
          <div class="list-item-cell notification-icons" [style.width.%]="3" [ngSwitch]="asset.openAlertPriority">
            <clr-icon *ngSwitchCase="OispPriority.LOW"    size="20" shape="info-standard" class="is-solid notification-low"></clr-icon>
            <clr-icon *ngSwitchCase="OispPriority.MEDIUM" size="20" shape="exclamation-circle" class="is-solid notification-medium"></clr-icon>
            <clr-icon *ngSwitchCase="OispPriority.HIGH"   size="20" shape="exclamation-triangle" class="is-solid notification-high"></clr-icon>
          </div>
        </td>
        <td [ngClass]="{'asset-needs-maintenance': isMaintenanceNeededSoon(asset)}"
            [style.width.%]="20">{{asset.name}}</td>
        <td [style.width.%]="18">{{asset.category}}</td>
        <td [style.width.%]="20">{{asset.manufacturer}}</td>
        <td [style.width.%]="12">{{asset.factorySiteName}}</td>
        <td [style.width.%]="13">
          <app-maintenance-progressbar [asset]="asset"
                                       [maintenancePercentage]="getMaintenanceDaysPercentage(asset)"
                                       [maintenanceValue]="getMaintenanceDaysValue(asset)"
                                       [state]="getMaintenanceState(getMaintenanceDaysValue(asset), MAINTENANCE_DAYS_LOWER_THRESHOLD, MAINTENANCE_DAYS_UPPER_THRESHOLD)"
          ></app-maintenance-progressbar>
        </td>
        <td [style.width.%]="13">
          <app-maintenance-progressbar [asset]="asset"
                                       [maintenancePercentage]="getMaintenanceHoursPercentage(asset)"
                                       [maintenanceValue]="getMaintenanceHoursValue(asset)"
                                       [state]="getMaintenanceState(getMaintenanceHoursValue(asset), MAINTENANCE_HOURS_LOWER_THRESHOLD, MAINTENANCE_HOURS_UPPER_THRESHOLD)"
          ></app-maintenance-progressbar>
        </td>
        <td [style.width.%]="2"></td>
      </tr>
    </ng-template>
  </p-table>
</div>

